The following guide explains how to create payments with the provided Satispay API.

Depending on the selected flow, payments experience different lifecycles.

* * *

# Payment lifecycle   [Skip link to Payment lifecycle](https://developers.satispay.com/reference/create-a-payment\#payment-lifecycle)

### [`MATCH_CODE`](https://developers.satispay.com/docs/one-off), [`MATCH_USER`](https://developers.satispay.com/docs/payment-mobile-number)   [Skip link to [object Object]](https://developers.satispay.com/reference/create-a-payment\#match_code-match_user)

These type of payments always begins in `PENDING` status.

They can transition to:

- `ACCEPTED` if:

  - the consumer accepts the payment via the Satispay App.
- `CANCELED` if:

  - the payment expires.
  - the user explicitly cancels the payment via the Satispay App.

`ACCEPTED` and `CANCELED` are final statuses which cannot be changed.

Show graph![](https://files.readme.io/196f746-graph.svg)

* * *

### [`PRE_AUTHORIZED`](https://developers.satispay.com/docs/automatic-payments), [`HOTP_AUTH`](https://developers.satispay.com/docs/one-off-hotp)   [Skip link to [object Object]](https://developers.satispay.com/reference/create-a-payment\#pre_authorized-hotp_auth)

For this payment types, the payment will be created in `ACCEPTED` status.

There are no transitional states, as if the charge on the user's wallet fails, the payment won't be generated, and you will receive a `4xx` status code.

* * *

### [`FUND_LOCK`](https://developers.satispay.com/docs/funds-lock-late-capture)   [Skip link to [object Object]](https://developers.satispay.com/reference/create-a-payment\#fund_lock)

This type of payment always begins in `PENDING` status.

It can transition from `PENDING` to:

- `AUTHORIZED` if:

  - the consumer authorizes the fund lock payment via the Satispay App.
- `CANCELED` if:

  - the user explicitly cancels the payment via the Satispay App.
  - the payment expires.

Once the payment status is in `AUTHORIZED`, it can transition to:

- `ACCEPTED` if:

  - the merchant accepts it via an `ACCEPT` action using the [Update payment API](https://developers.satispay.com/docs/update-a-payment).
- `CANCELED` if:

  - the merchant cancels it via a `CANCEL` action using the [Update payment API](https://developers.satispay.com/docs/update-a-payment).
  - the payment expires.

`ACCEPTED` and `CANCELED` are final statuses which cannot be changed.

Show graph![](https://files.readme.io/26a56f3-graph_1.svg)

* * *

### [`PRE_AUTHORIZED_FUND_LOCK`](https://developers.satispay.com/docs/automatic-funds-lock)   [Skip link to [object Object]](https://developers.satispay.com/reference/create-a-payment\#pre_authorized_fund_lock)

This type of payment always begins in `AUTHORIZED` status.

There are no transitional states, as if the authorization on the user's wallet fails, the payment won't be generated, and you will receive a `4xx` status code.

It can transition from `AUTHORIZED` to:

- `ACCEPTED` if:

  - the merchant accepts it via an `ACCEPT` action using the [Update payment API](https://developers.satispay.com/docs/update-a-payment).
- `CANCELED` if:

  - the merchant cancels it via a `CANCEL` action using the [Update payment API](https://developers.satispay.com/docs/update-a-payment).
  - the payment expires.

`ACCEPTED` and `CANCELED` are final statuses which cannot be changed.

Show graph![](https://files.readme.io/714c10d-graph_2.svg)

* * *

# Refunds   [Skip link to Refunds](https://developers.satispay.com/reference/create-a-payment\#refunds)

Refunds can only be processed via our API.

To perform refunds you need to create a new payment with the `REFUND` flow.

You will need to send the `parent_payment_uid` with the payment id that you want to refund and the `amount_unit` that you want to refund for that specific payment.

We suggest you to fill the `external_code` with your internal order id, in order to better reconcile refunds in your payment reports.

This field will also be shown to the user via the Satispay app.

Refund can only be created in `ACCEPTED` status.

There are no transitional states, as if the refund fails, the refund won't be generated, and you will receive a `4xx` status code.

If the refund goes well, you can distinguish the refund payment by using the response `type` property, which will be `REFUND_TO_BUSINESS`.

* * *

### Refunds for payments with only e-money   [Skip link to Refunds for payments with only e-money](https://developers.satispay.com/reference/create-a-payment\#refunds-for-payments-with-only-e-money)

Refunds are only possible within `365` days from the payment creation date.

It is possible to create multiple partial refunds until you reach the total amount of the payment that you want to refund.

* * *

### Refunds for payments with Meal Voucher   [Skip link to Refunds for payments with Meal Voucher](https://developers.satispay.com/reference/create-a-payment\#refunds-for-payments-with-meal-voucher)

Refunds are only possible on the same day of payment creation and for the total amount of the payment.

Partial refunds in payments with Meal Voucher are not available.

* * *

### Refunds for payments with Fringe Benefits   [Skip link to Refunds for payments with Fringe Benefits](https://developers.satispay.com/reference/create-a-payment\#refunds-for-payments-with-fringe-benefits)

Refunds are only possible within the same month of the payment creation and must be for the total amount. Partial refunds for payments made with Fringe Benefits are not available.

* * *

## REQUEST   [Skip link to REQUEST](https://developers.satispay.com/reference/create-a-payment\#request)

flow

string

required

The payment flow that you want to use.

`MATCH_CODE` [DOC](https://developers.satispay.com/docs/one-off)

This flow can be used generically for one-off payments.

`HOTP_AUTH` [DOC](https://developers.satispay.com/docs/one-off-hotp)

This flow can be used to perform one-off payments via HOTP tokens.

To use this flow you must also include the `token` parameter.

`MATCH_USER` [DOC](https://developers.satispay.com/docs/payment-mobile-number)

This flow can be used for one-off payments on a specific user.

To use this flow you must also include the `consumer_uid` parameter.

`FUND_LOCK` [DOC](https://developers.satispay.com/docs/funds-lock-late-capture)

This flow can be used for funds lock payments.

`PRE_AUTHORIZED` [DOC](https://developers.satispay.com/docs/automatic-payments)

This flow can be used for automatic payments.

To use this flow you must also include the `token` parameter.

`PRE_AUTHORIZED_FUND_LOCK` [DOC](https://developers.satispay.com/docs/automatic-funds-lock)

This flow can be used for automatic funds lock payments.

To use this flow you must also include the `token` parameter.

`REFUND`

This flow can be used for refunds on a specific payment.

To use this flow you must also include the `parent_payment_uid` and the `amount_unit`.

amount\_unit

integer

required

The payment amount in cents.

For example, to represent the amount `€12.40`, you should multiply it by `100`, resulting in `1240` cents.

currency

string

required

Defaults to EUR

The payment currency.

Currently `EUR` is the only currency supported.

token

string

The token required to charge the consumer wallet.

It can be an automatic payment or HOTP token.

Required with `HOTP_AUTH`, `PRE_AUTHORIZED` and `PRE_AUTHORIZED_FUND_LOCK` flows only.

parent\_payment\_uid

string

The id of the payment that you want to refund.

Required with `REFUND` flow only.

external\_code

string

The external order id or payment identifier.

We highly recommend to use this field by populating it with your internal order id.

This string will be included in your reports for reconciliation and shown to the Satispay consumer in-app.

This field has a maximum length of 50 characters, including spaces.

callback\_url

string

The URL to be triggered via an HTTP GET request when there is a change in payment status.

When the given `callback_url` is invoked, a GET request for payment details can be made to retrieve the updated payment status.

Please note that `{uuid}` will be replaced with the generated payment id.

e.g. `https://example.com/satispay-callback?payment_id={uuid}`

You can read more [here](https://developers.satispay.com/reference/callback-s2s).

redirect\_url

string

This field specifies the URL where the user will be redirected after the payment flow from the Satispay app is completed.

For instance, you can set this URL to ensure users are redirected to that specific page upon successful payment completion.

e.g. `https://example.com/payment-redirect?order_id=your_order_id`

Please note that this field doesn't support any placeholder.

metadata

object

The additional metadata for the payment.

This field supports up to 20 key-value pairs, with keys limited to 45 characters and values limited to 500 characters each.

metadata object

expiration\_date

string

The UTC payment expiration datetime.

The format should be `ISO 8601` like this `yyyy-MM-dd'T'HH:mm:ss.SSSZ`.

By default:

`MATCH_CODE` and `MATCH_USER` payments are valid for 2 hours.

`FUND_LOCK` payments are valid for 10 days.

`PRE_AUTHORIZED_FUND_LOCK` payments are valid for 5 days.

This timeframe is calculated from the moment of creation.

This parameter cannot be used with `PRE_AUTHORIZED`, `HOTP_AUTH` and `REFUND` flows.

Show Deprecated

Content-Type

string

required

Always send this header as `application/json`.

Host

string

required

The host declared in the [signature](https://developers.satispay.com/reference/sign-the-string).

Date

string

required

The date declared in the [signature](https://developers.satispay.com/reference/sign-the-string).

Digest

string

required

The digest declared in the [signature](https://developers.satispay.com/reference/sign-the-string).

Authorization

string

required

The request [signature](https://developers.satispay.com/reference/sign-the-string).

Idempotency-Key

string

The idempotent request key.

You can read more [here](https://developers.satispay.com/reference/idempotency).

x-satispay-deviceinfo

string

The device information (e.g., hostname).

x-satispay-devicetype

string

The device type.

x-satispay-os

string

The Operating System name (e.g., Windows).

x-satispay-osv

string

The Operating System version (e.g., 10).

x-satispay-apph

string

The software house name (e.g., Satispay).

x-satispay-appn

string

The software name (e.g., My awesome app).

x-satispay-appv

string

The software version (e.g., v2.0.0).

x-satispay-tracking-code

string

The tracking code used by Satispay commercial partners.

Use this code only if explicitly required by Satispay.

# `` 200      OK

object

id

string

The unique payment id.

This can be used for every eventual subsequent operations on the payment, including refunds.

code\_identifier

string

The Satispay code identifier.

This string can be encoded in a QR code that can be scanned by the user.

This property is only available in `MATCH_CODE` flow payments.

type

string

The current payment type.

`TO_BUSINESS`

This type is used for payments from a consumer to a merchant.

`REFUND_TO_BUSINESS`

This type is used for payments from a merchant to a consumer (e.g. refunds).

amount\_unit

integer

The payment amount in cents.

For example, the amount `€12.40` is being represented as `1240` cents.

currency

string

The payment currency.

`EUR`

status

string

The current payment status.

`PENDING`

The payment is created and awaits user interaction, such as scanning the QR code.

`AUTHORIZED` \- for `FUND_LOCK` and `PRE_AUTHORIZED_FUND_LOCK` flows only.

The payment has been authorized by the user and is ready to be confirmed by the merchant with the [Update payment API](https://developers.satispay.com/docs/update-a-payment).

`ACCEPTED`

The payment has been accepted and succesfully executed.

expired

boolean

The current payment expiration status.

It becomes `true` once it reaches the `expiration_date` without being accepted or canceled.

metadata

object

The additional metadata for the payment.

Has additional fields

sender

object

The sender payment actor.

id

string

The unique sender id.

This will only be available once the payment will be matched with a consumer.

type

string

The sender type.

`CONSUMER`

This sender type is used when the payment goes from a consumer to a merchant.

`SHOP`

This sender type is used when the payment goes from a merchant to a consumer (e.g. refunds payments).

name

string

The sender name.

This will only be available once the payment will be matched with a consumer.

receiver

object

The receiver payment actor.

id

string

The unique receiver id.

type

string

The receiver type.

`CONSUMER`

This receiver type is used when the payment goes from a merchant to a consumer.

`SHOP`

This receiver type is used when the payment goes from a consumer to a merchant (e.g. refunds payments).

insert\_date

string

The UTC payment creation datetime.

expire\_date

string

The UTC payment expiration datetime.

This property can be ignored when using `PRE_AUTHORIZED` or `HOTP_AUTH` flows.

description

string

deprecated

The external\_code set during the payment creation request.

Please use the `external_code` field instead.

flow

string

deprecated

external\_code

string

The `external_code` set during the creation request.

redirect\_url

string

The URL where the user will be redirected after the payment flow from the Satispay app is completed.

This property is available only when the payment uses the `MATCH_CODE`, `MATCH_USER` or `FUND_LOCK` flow.

# `` 400      400 Bad Request

object

code

string

The specific system error code.

`21`

Insufficient availability.

`36`

Malformed flow, payment or metadata.

`131`

Payment too old to be refunded.

It is possible to refund payments within the past 365 days from creation.

`27`

Payment not allowed.

Consumer or shop are currently not able to pay/receive payments.

Please note that this condition could be temporary.

`172`

Pre authorized payments token is not valid.

`246`

The HOTP token is not valid.

message

string

The error message.

wlt

string

The request CID/WLT, save this string in case of errors.

This will help our IT support to trace the request.

# `` 401      401 Unauthorized

object

code

string

The specific system error code.

`34`

Merchant not found or unauthorized.

message

string

The error message.

wlt

string

The request CID/WLT, save this string in case of errors.

This will help our IT support to trace the request.

# `` 403      403 Forbidden or invalid authorization header

object

code

string

The specific system error code.

`45`

Unable to fulfill the request.

`70`

Anti-hammering violation.

message

string

The error message.

wlt

string

The request CID/WLT, save this string in case of errors.

This will help our IT support to trace the request.

Updated 5 months ago

* * *

ShellPHP

Base URL

https://authservices.satispay.com/g\_business/v1/payments

```

xxxxxxxxxx

23

1curl --request POST \

2  --url https://authservices.satispay.com/g_business/v1/payments \

3  --header 'Content-Type: application/json' \

4  --header 'Host: authservices.satispay.com' \

5  --header 'Date: Fri, 01 Jul 2020 09:18:17 GMT' \

6  --header 'Digest: SHA-256=...' \

7  --header 'Authorization: Signature keyId="4ekqhm...", algorithm="rsa-sha256", headers="(request-target) host date digest", signature="C5yynRx..."' \

8  --data '{

9    "flow": "MATCH_CODE",

10    "amount_unit": 1240,

11    "currency": "EUR",

12    "external_code": "my_order_id",

13    "callback_url": "https://example.com/satispay-callback?payment_id={uuid}",

14    "redirect_url": "https://example.com/satispay-redirect?order_id=my_order_id",

15    "metadata": {

16      "order_id": "my_order_id",

17      "user_id": "my_user_id",

18      "payment_id": "my_payment_id",

19      "session_id": "my_session_id",

20      "key": "value"

21    }

22  }'

23​

```

```

xxxxxxxxxx

29
}

1

{

2  "id": "2ee5f6c7-f85d-45b7-8f1b-2a570a7002eb",

3  "code_identifier": "S6Y-PAY--2EE5F6C7-F85D-45B7-8F1B-2A570A7002EB",

4  "type": "TO_BUSINESS",

5  "amount_unit": 1240,

6  "currency": "EUR",

7  "status": "PENDING",

8  "expired": false,

9

  "metadata": {

10    "order_id": "my_order_id",

11    "user_id": "my_user_id",

12    "payment_id": "my_payment_id",

13    "session_id": "my_session_id",

14    "key": "value"

15  },

16

  "sender": {

17    "type": "CONSUMER"

18  },

19

  "receiver": {

20    "id": "0c4f4511-1afa-4b17-b529-ff7465d126c1",

21    "type": "SHOP"

22  },

23  "insert_date": "2020-07-01T09:18:17.166Z",

24  "expire_date": "2020-07-01T11:18:17.163Z",

25  "description": "my_order_id",

```

Updated 5 months ago

* * *